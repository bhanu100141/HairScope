import{j as e,A as $,m as x,G as C}from"./vendor-aYM8PsQt.js";import{a as H,r as o,R as D,u as v,b as z,c as W,d as y,N as R,B as Y}from"./react-BB5n2w1Y.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();var G,B=H;G=B.createRoot,B.hydrateRoot;const U={username:"Bhanuprasad",password:"Password@123"},K=async(t,r)=>new Promise(i=>{setTimeout(()=>{i(t===U.username&&r===U.password)},500)}),u={deadline:"hs_deadline_ts",exhausted:"hs_exhausted"},E=10;function L(){return Date.now()}function q(){if(typeof window>"u")return;localStorage.removeItem(u.exhausted);const t=localStorage.getItem(u.deadline);if(t)console.log("Using existing deadline:",new Date(Number(t)).toISOString());else{const r=L()+E*60*1e3;localStorage.setItem(u.deadline,r.toString()),console.log(`Session started. Expires in ${E} minutes.`)}}function P(){if(typeof window>"u")return null;const t=localStorage.getItem(u.deadline);return t?Number(t):null}function k(){if(typeof window>"u")return 0;const t=P();if(!t)return E*60*1e3;const r=Math.max(0,t-L());return console.debug(`Remaining time: ${Math.floor(r/1e3)}s`),r}function S(){typeof window>"u"||(localStorage.setItem(u.exhausted,"1"),console.log("Session marked as exhausted"))}function j(){if(typeof window>"u")return!0;if(localStorage.getItem(u.exhausted)==="1")return console.log("Session is explicitly marked as exhausted"),!0;const t=P(),r=L();return t&&t<=r?(console.log("Session deadline has passed, marking as exhausted"),S(),!0):!t&&window.location.pathname==="/lab"?(console.log("No deadline set but in lab, marking as exhausted"),S(),!0):!1}function T(){if(typeof window>"u")return;console.log("Resetting all timer data"),localStorage.removeItem(u.deadline),localStorage.removeItem(u.exhausted),localStorage.setItem(u.exhausted,"1"),localStorage.removeItem(u.exhausted),window.sessionStorage&&sessionStorage.clear();const t=new StorageEvent("storage",{key:u.exhausted,newValue:null,oldValue:"1",storageArea:localStorage,url:window.location.href});window.dispatchEvent(t),S()}const J=({playing:t,size:r=80,onComplete:i})=>{const[c,n]=o.useState(!1),[s,a]=o.useState(!1);return o.useEffect(()=>{if(t&&!s){console.log("Starting lock animation"),n(!0),a(!0);const l=setTimeout(()=>{console.log("Lock animation completed"),n(!1),a(!1),i==null||i()},1500);return()=>{console.log("Cleaning up lock animation"),clearTimeout(l)}}},[t,s,i]),c?e.jsx($,{children:e.jsx(x.div,{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:e.jsxs(x.div,{className:"flex flex-col items-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:[e.jsxs(x.svg,{width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-indigo-600",animate:{rotate:[0,360],opacity:[1,.8,1]},transition:{rotate:{duration:1.5,ease:"easeInOut",repeat:0},opacity:{duration:1.5,ease:"easeInOut",repeat:0}},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),e.jsx(x.p,{className:"mt-4 text-lg font-medium text-white",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:"Access Granted"})]})})}):null},Q=({isOpen:t,onAnimationComplete:r})=>{const[i,c]=o.useState(!1),[n,s]=o.useState(!1);o.useEffect(()=>{console.log("[SlidingDoors] isOpen changed:",t),t&&!i?(console.log("[SlidingDoors] Starting animation"),c(!0),s(!1)):!t&&i&&!n&&(console.log("[SlidingDoors] Starting close animation"),s(!0))},[t,i,n]);const a=()=>{if(t&&!n){console.log("[SlidingDoors] Open animation complete"),s(!0);const l=setTimeout(()=>{console.log("[SlidingDoors] Triggering onAnimationComplete"),r==null||r()},300);return()=>clearTimeout(l)}};return i?e.jsxs("div",{className:"fixed inset-0 z-50 flex pointer-events-none",children:[e.jsx(x.div,{className:"h-full w-1/2 bg-indigo-700",initial:{x:0},animate:{x:t?"-100%":0},transition:{duration:.8,ease:[.22,1,.36,1]},onAnimationComplete:a}),e.jsx(x.div,{className:"h-full w-1/2 bg-indigo-700",initial:{x:0},animate:{x:t?"100%":0},transition:{duration:.8,ease:[.22,1,.36,1]}})]}):null};function X(t){return C({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}}]})(t)}function Z(t){return C({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(t)}const ee=()=>{console.log("Login component rendering...");const[t,r]=o.useState(""),[i,c]=o.useState(""),[n,s]=o.useState(!1),[a,l]=o.useState(""),[m,p]=o.useState(!1),[g,h]=o.useState(!1),[f,N]=o.useState(!1),[b,I]=o.useState(!1),A=v(),M=o.useCallback(()=>{console.log("[DEBUG] handleAuthSuccess called"),N(!0);const d=setTimeout(()=>{console.log("[DEBUG] Showing sliding doors"),N(!1),I(!0)},1500);return()=>clearTimeout(d)},[]);o.useEffect(()=>{console.log("[DEBUG] Login mounted, checking session...");const d=j();console.log("[DEBUG] isExhausted:",d),h(d)},[]);const O=async d=>{if(d.preventDefault(),console.log("[DEBUG] Form submitted"),!t||!i){console.log("[DEBUG] Validation failed: Missing credentials"),l("Please enter both username and password");return}p(!0),l(""),console.log("[DEBUG] Starting authentication...");try{console.log("[DEBUG] Validating credentials...");const w=await K(t,i);if(console.log("[DEBUG] Authentication result:",w),!w){console.log("[DEBUG] Invalid credentials"),l("Invalid username or password"),p(!1);return}console.log("[DEBUG] Authentication successful"),M()}catch(w){console.error("[ERROR] Login error:",w),l("An error occurred. Please try again."),p(!1)}},F=o.useCallback(()=>{console.log("[DEBUG] handleDoorsAnimationComplete called");try{console.log("[DEBUG] Setting deadline..."),q(),setTimeout(()=>{console.log("[DEBUG] Navigating to /lab"),A("/lab",{replace:!0})},100)}catch(d){console.error("[ERROR] Error in handleDoorsAnimationComplete:",d)}},[A]),_=()=>{s(!n)};return o.useEffect(()=>{console.log("[DEBUG] State update:",{showLock:f,showDoors:b,isLoading:m,showRestriction:g,hasError:!!a})},[f,b,m,g,a]),g?(console.log("[DEBUG] Showing restriction message"),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Access Restricted"}),e.jsx("p",{className:"text-gray-700 mb-6",children:"Your session has expired. Please contact support for assistance."})]})})):(console.log("[DEBUG] Rendering login form"),e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:[f&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-white bg-opacity-90",children:e.jsx(J,{playing:!0,size:80,onComplete:()=>{N(!1),I(!0)}})}),e.jsx(Q,{isOpen:b,onAnimationComplete:F}),!f&&!b&&e.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"HairScope Lab"}),a&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded text-sm",children:a}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),e.jsx("input",{id:"username",type:"text",value:t,onChange:d=>r(d.target.value),placeholder:"Enter your username",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",disabled:m,autoComplete:"username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:n?"text":"password",value:i,onChange:d=>c(d.target.value),placeholder:"Enter your password",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent pr-10",disabled:m,autoComplete:"current-password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:_,tabIndex:-1,children:n?e.jsx(X,{className:"h-5 w-5"}):e.jsx(Z,{className:"h-5 w-5"})})]})]}),e.jsx("button",{type:"submit",disabled:m,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Signing in...":"Sign In"})]})]})]}))},te=D.memo(ee),se=()=>{const t=v(),[r,i]=o.useState("10:00"),[c,n]=o.useState(!1),s=o.useRef(null),a=o.useRef(Date.now()),l=o.useCallback(g=>{const h=Math.floor(g/6e4),f=Math.floor(g%6e4/1e3);i(`${h}:${f.toString().padStart(2,"0")}`)},[]),m=o.useCallback(()=>{const g=k(),h=Date.now();return h-a.current>=500&&(l(g),a.current=h),g<=0?(console.log("Session expired, marking as exhausted"),S(),n(!0),t("/",{replace:!0}),!1):!0},[t,l]);o.useEffect(()=>{if(console.log("Lab component mounted, checking session..."),!!m())return s.current=window.setInterval(m,500),()=>{s.current&&(clearInterval(s.current),s.current=null)}},[m]);const p=o.useCallback(()=>{console.log("User clicked exit, resetting session"),s.current&&(clearInterval(s.current),s.current=null),T(),window.location.href="/"},[]);return c?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Session Expired"}),e.jsx("p",{className:"mb-4",children:"Your session has ended. Please log in again to continue."}),e.jsx("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Return to Login"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"HairScope Lab"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:["Time Remaining: ",r]}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Exit Lab"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Lab Interface"}),e.jsx("p",{className:"text-gray-600",children:"Welcome to the HairScope Lab. Your session will automatically expire after 10 minutes of inactivity."})]})]})})},ne=D.memo(se),oe=()=>{const t=v();return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Test Page"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"If you can see this page, the routing is working correctly!"}),e.jsx("button",{onClick:()=>t("/"),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Go to Home"})]})},re=()=>{const t=z(),r=v(),[i,c]=o.useState(!1);return o.useEffect(()=>{console.log("[App] Route changed to:",t.pathname)},[t]),o.useEffect(()=>{var s;if(console.log("[App] Path changed to:",t.pathname),t.pathname==="/test"){c(!0);return}if((s=t.state)!=null&&s.fromExit){console.log("[App] Handling exit flow, forcing session reset"),T(),window.history.replaceState({},document.title),c(!0);return}(()=>{const a=k(),l=!j()&&a>0;console.log("[App] Session status:",{isExhausted:j(),remainingMs:a,isValid:l,currentPath:t.pathname}),t.pathname==="/lab"&&!l&&(console.log("[App] No valid session, redirecting to login"),r("/",{replace:!0})),t.pathname==="/"&&l&&(console.log("[App] Valid session found, redirecting to lab"),r("/lab",{replace:!0})),c(!0)})()},[t.pathname,r,t.state]),i?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs(W,{children:[e.jsx(y,{path:"/",element:e.jsx(te,{})}),e.jsx(y,{path:"/lab",element:!j()&&k()>0?e.jsx(ne,{}):e.jsx(R,{to:"/",replace:!0})}),e.jsx(y,{path:"/test",element:e.jsx(oe,{})}),e.jsx(y,{path:"*",element:e.jsx(R,{to:"/",replace:!0})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600"})})},V=document.getElementById("root");if(!V)throw new Error("Failed to find the root element");const ie=G(V);ie.render(e.jsx(D.StrictMode,{children:e.jsx(Y,{children:e.jsx(re,{})})}));
